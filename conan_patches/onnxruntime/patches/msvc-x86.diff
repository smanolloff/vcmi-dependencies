--- a/cmake/adjust_global_compile_flags.cmake
+++ b/cmake/adjust_global_compile_flags.cmake
@@ -230,6 +230,8 @@ if (MSVC)
   if (CMAKE_VS_PLATFORM_NAME)
     # Multi-platform generator
     set(onnxruntime_target_platform ${CMAKE_VS_PLATFORM_NAME})
+  elseif (CMAKE_C_COMPILER_ARCHITECTURE_ID)
+    string(TOLOWER "${CMAKE_C_COMPILER_ARCHITECTURE_ID}" onnxruntime_target_platform)
   else()
     set(onnxruntime_target_platform ${CMAKE_SYSTEM_PROCESSOR})
   endif()
@@ -238,7 +240,7 @@ if (MSVC)
     enable_language(ASM_MARMASM)
   elseif (onnxruntime_target_platform STREQUAL "ARM64EC")
     enable_language(ASM_MARMASM)
-  elseif (onnxruntime_target_platform STREQUAL "ARM" OR CMAKE_GENERATOR MATCHES "ARM")
+  elseif (onnxruntime_target_platform STREQUAL "ARM" OR CMAKE_GENERATOR MATCHES "ARM" OR onnxruntime_target_platform STREQUAL "arm64")
     set(onnxruntime_target_platform "ARM")
     enable_language(ASM_MARMASM)
   elseif (onnxruntime_target_platform STREQUAL "x64" OR onnxruntime_target_platform STREQUAL "x86_64" OR onnxruntime_target_platform STREQUAL "AMD64" OR CMAKE_GENERATOR MATCHES "Win64")
@@ -250,7 +252,7 @@ if (MSVC)
     message("Enabling SAFESEH for x86 build")
     set(CMAKE_ASM_MASM_FLAGS "${CMAKE_ASM_MASM_FLAGS} /safeseh")
   else()
-    message(FATAL_ERROR "Unknown CMAKE_SYSTEM_PROCESSOR: ${CMAKE_SYSTEM_PROCESSOR}")
+    message(FATAL_ERROR "Unknown onnxruntime_target_platform: ${onnxruntime_target_platform}")
   endif()
 
 
